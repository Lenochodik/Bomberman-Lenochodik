/*
First time? Check out the tutorial game:
https://sprig.hackclub.com/gallery/getting_started

@title: Bomberman
@author: 
@tags: []
@addedOn: 2024-00-00
*/

const player = "p"
const bomb1 = "1"
const bomb2 = "2"
const bomb3 = "3"
const crate = "c"


setLegend(
  [player, bitmap`
...CC.....CC....
6.CCCCCCCCCCC...
96CCCCCCCCCCC...
3..C0200020C....
00.CC20002CC....
00.CC22022CC....
C0..C00200C..9..
CC...CCCCC...F..
.CC.CCCCCCC.F...
.CCCCC222CC0FLL.
..CCC222220002LL
...CC2222200001L
...CCC222C00000L
....CCCCCC000000
.....C...C.0000.
....LL...LL.....`],
  [bomb1, bitmap`
.......6........
.......66.......
......639.......
......939.......
.......F6.......
....000FL00.....
...0000L1L00....
..00000002100...
..00000000210...
..000000000L0...
..00000000000...
..00000000000...
..00000000000...
..00000000000...
...000000000....
....0000000.....`],
  [bomb2, bitmap`
  
.......6........
.......66.......
......639.......
......939.......
......939.......
.......F6.......
....000FL00.....
...0000L1L00....
..00000002100...
..00000000210...
..00000000LL0...
..000000000L0...
..00000000L00...
..00000000000...
...000000000....
....0000000.....`],
  [bomb3, bitmap`
.......6........
.......66.......
......639.......
......939.......
......939.......
......939.......
.......F6.......
....000FL00.....
...0000L1L00....
..00000012100...
..00000001210...
..000000002L0...
..000000001L0...
..0000000LL00...
...0000000L0....
....0000000.....`],
  [crate, bitmap`
FFFFFFFFFFFFFFFF
FF666666666666FF
F6F6666666666F6F
F66FFFFFFFFFF66F
F66F66F66F66F66F
F66F66F66F66F66F
F66F66F66F66F66F
F66F66F66F66F66F
F66F66F66F66F66F
F66F66F66F66F66F
F66F66F66F66F66F
F66F66F66F66F66F
F66FFFFFFFFFF66F
F6F6666666666F6F
FF666666666666FF
FFFFFFFFFFFFFFFF`],
)

setSolids([player, bomb1, bomb2, bomb3, crate])

let level = 0
const levels = [
  map`
..........
..........
p.12321c..
..........
..........
..........
..........
..........`
]

const soundBombPlant = tune`
500: C5^500,
15500`
const melody1 = tune`
123.96694214876032: C5~123.96694214876032,
123.96694214876032: E5~123.96694214876032,
123.96694214876032: C5~123.96694214876032,
123.96694214876032: D5~123.96694214876032,
123.96694214876032: E5~123.96694214876032,
123.96694214876032,
123.96694214876032: D5~123.96694214876032,
123.96694214876032: E5~123.96694214876032,
123.96694214876032: D5~123.96694214876032,
123.96694214876032: C5~123.96694214876032,
247.93388429752065,
123.96694214876032: C5~123.96694214876032,
123.96694214876032: E5~123.96694214876032,
123.96694214876032: C5~123.96694214876032,
123.96694214876032: D5~123.96694214876032,
123.96694214876032: E5~123.96694214876032,
123.96694214876032,
123.96694214876032: D5~123.96694214876032,
123.96694214876032: E5~123.96694214876032,
123.96694214876032: D5~123.96694214876032,
123.96694214876032: C5~123.96694214876032,
247.93388429752065,
123.96694214876032: C5~123.96694214876032,
123.96694214876032: E5~123.96694214876032,
123.96694214876032: C5~123.96694214876032,
123.96694214876032: D5~123.96694214876032,
123.96694214876032: E5~123.96694214876032,
123.96694214876032,
123.96694214876032: D5~123.96694214876032,
123.96694214876032: E5~123.96694214876032`
const soundPlayerMove = tune`
500: D5~500,
15500`
const soundPlayerMoveForbidden = tune`
500: D5~500 + E5~500 + F5~500,
15500`

setMap(levels[level])

setPushables({
  [player]: []
})

let playerObject = getFirst(player)

onInput("s", () => {
  playerObject.y += 1
  playTune(soundPlayerMove)
})

onInput("w", () => {
  playerObject.y -= 1
  playTune(soundPlayerMove)
})

onInput("a", () => {
  playerObject.x -= 1
  playTune(soundPlayerMove)
})

onInput("d", () => {
  playerObject.x += 1
  playTune(soundPlayerMove)
})

onInput("k", () => {
  // Spawn a bomb
  addSprite(playerObject.x, playerObject.y, bomb1)
  playTune(soundBombPlant)
})
